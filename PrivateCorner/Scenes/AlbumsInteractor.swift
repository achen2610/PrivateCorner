//
//  AlbumsInteractor.swift
//  PrivateCorner
//
//  Created by a on 3/15/17.
//  Copyright (c) 2017 MrAChen. All rights reserved.
//
//  This file was generated by the Clean Swift HELM Xcode Templates
//

import UIKit

protocol AlbumsInteractorInput {
    func getAlbum(request: AlbumsScene.GetAlbum.Request)
    func selectAlbum(request: AlbumsScene.SelectAlbum.Request)
    func addAlbum(request: AlbumsScene.AddAlbum.Request)
    func deleteAlbum(request: AlbumsScene.DeleteAlbum.Request)
}

protocol AlbumsInteractorOutput {
    func presentAlbum(response: AlbumsScene.GetAlbum.Response)
    func addAlbum(response: AlbumsScene.AddAlbum.Response)
    func deleteAlbum(response: AlbumsScene.DeleteAlbum.Response)
}

protocol AlbumsDataSource {
    var selectedAlbum:Album! { get }
}

protocol AlbumsDataDestination {
    
}

class AlbumsInteractor: AlbumsInteractorInput, AlbumsDataSource, AlbumsDataDestination {
    
    var output: AlbumsInteractorOutput!
    var selectedAlbum:Album!
    
    // MARK: Business logic
    
    // Get Album
    func getAlbum(request: AlbumsScene.GetAlbum.Request) {
        let result = AlbumManager.sharedInstance.getAlbums()
        handleGetAlbumResult(result: result)
    }
    
    private func handleGetAlbumResult(result: [Album]) {
        let response = AlbumsScene.GetAlbum.Response(albums: result)
        output.presentAlbum(response: response)
    }
    
    // Select Album
    func selectAlbum(request: AlbumsScene.SelectAlbum.Request) {
        selectedAlbum = request.album
    }

    // Add Album
    func addAlbum(request: AlbumsScene.AddAlbum.Request) {
        let album = AlbumManager.sharedInstance.addAlbum(title: request.title)
        let response = AlbumsScene.AddAlbum.Response(album: album)
        output.addAlbum(response: response)
    }
    
    // Delete Album
    func deleteAlbum(request: AlbumsScene.DeleteAlbum.Request) {
        let album = request.album
        AlbumManager.sharedInstance.deleteAlbum(album: album)
        
        let index = request.index
        let response = AlbumsScene.DeleteAlbum.Response(index: index)
        output.deleteAlbum(response: response)
    }
}
